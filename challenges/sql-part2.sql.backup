-- ====================================
-- SQL Language Challenges - Part 2
-- Levels 51-100 (MEDIUM 30ê°œ + HARD 20ê°œ)
-- ====================================

-- Unit 11: ë³µì¡í•œ JOIN (5 problems - MEDIUM)
INSERT INTO challenges_sql (slug, language, kind, level, title, description, category, difficulty, problem_description, constraints, examples, initial_code, solution_code, test_cases, hints, tags, estimated_time) VALUES
('sql-right-join', 'sql', 'syntax', 51, 'RIGHT JOIN ì‚¬ìš©', 'ì˜¤ë¥¸ìª½ í…Œì´ë¸” ê¸°ì¤€ ì¡°ì¸', 'challenge', 2,
'departments í…Œì´ë¸”ì„ ê¸°ì¤€ìœ¼ë¡œ employeesì™€ RIGHT JOINí•˜ì—¬ ë¶€ì„œëª…ê³¼ ì§ì›ëª…ì„ ì¡°íšŒí•˜ì„¸ìš”.',
'- RIGHT JOIN ì‚¬ìš©\n- ë¶€ì„œê°€ ìˆì§€ë§Œ ì§ì›ì´ ì—†ëŠ” ê²½ìš°ë„ í¬í•¨',
'[{"input": "", "output": "ë¶€ì„œëª…, ì§ì›ëª…(NULL í¬í•¨)"}]',
'-- departmentsì™€ employeesë¥¼ RIGHT JOINí•˜ì„¸ìš”\n',
'SELECT d.dept_name, e.emp_name\nFROM employees e\nRIGHT JOIN departments d ON e.dept_id = d.dept_id;',
'[{"input": "", "expected": "right join result"}]',
'["RIGHT JOINì€ ì˜¤ë¥¸ìª½ í…Œì´ë¸”ì˜ ëª¨ë“  í–‰ì„ í¬í•¨í•©ë‹ˆë‹¤"]',
ARRAY['join', 'right-join'], 10),

('sql-full-outer-join', 'sql', 'syntax', 52, 'FULL OUTER JOIN', 'ì–‘ìª½ ëª¨ë‘ í¬í•¨í•˜ëŠ” ì¡°ì¸', 'challenge', 2,
'employeesì™€ departmentsë¥¼ FULL OUTER JOINí•˜ì—¬ ëª¨ë“  ì§ì›ê³¼ ëª¨ë“  ë¶€ì„œë¥¼ ì¡°íšŒí•˜ì„¸ìš”.',
'- FULL OUTER JOIN ë˜ëŠ” FULL JOIN ì‚¬ìš©\n- ë§¤ì¹­ë˜ì§€ ì•ŠëŠ” ê²½ìš° NULL',
'[{"input": "", "output": "ì§ì›ëª…, ë¶€ì„œëª… (ëª¨ë‘ í¬í•¨)"}]',
'-- employeesì™€ departmentsë¥¼ FULL OUTER JOINí•˜ì„¸ìš”\n',
'SELECT e.emp_name, d.dept_name\nFROM employees e\nFULL OUTER JOIN departments d ON e.dept_id = d.dept_id;',
'[{"input": "", "expected": "full outer join result"}]',
'["FULL OUTER JOINì€ ì–‘ìª½ í…Œì´ë¸”ì˜ ëª¨ë“  í–‰ì„ í¬í•¨í•©ë‹ˆë‹¤"]',
ARRAY['join', 'full-outer-join'], 10),

('sql-self-join', 'sql', 'syntax', 53, 'SELF JOIN', 'ê°™ì€ í…Œì´ë¸”ë¼ë¦¬ ì¡°ì¸', 'challenge', 2,
'employees í…Œì´ë¸”ì„ ìê¸° ìì‹ ê³¼ ì¡°ì¸í•˜ì—¬ ì§ì›ê³¼ ê·¸ì˜ ë§¤ë‹ˆì € ì´ë¦„ì„ ì¡°íšŒí•˜ì„¸ìš”.',
'- ê°™ì€ í…Œì´ë¸”ì„ ì„œë¡œ ë‹¤ë¥¸ ë³„ì¹­ìœ¼ë¡œ ì¡°ì¸\n- manager_idë¡œ ì¡°ì¸',
'[{"input": "", "output": "ì§ì›ëª…, ë§¤ë‹ˆì €ëª…"}]',
'-- employeesë¥¼ self joiní•˜ì—¬ ì§ì›ê³¼ ë§¤ë‹ˆì €ë¥¼ ì¡°íšŒí•˜ì„¸ìš”\n',
'SELECT e.emp_name AS employee, m.emp_name AS manager\nFROM employees e\nLEFT JOIN employees m ON e.manager_id = m.emp_id;',
'[{"input": "", "expected": "employee-manager pairs"}]',
'["ê°™ì€ í…Œì´ë¸”ì— ì„œë¡œ ë‹¤ë¥¸ ë³„ì¹­ì„ ì‚¬ìš©í•˜ì„¸ìš”"]',
ARRAY['join', 'self-join'], 12),

('sql-cross-join', 'sql', 'syntax', 54, 'CROSS JOIN', 'ì¹´í‹°ì…˜ ê³± ì¡°ì¸', 'challenge', 2,
'productsì™€ colors í…Œì´ë¸”ì„ CROSS JOINí•˜ì—¬ ëª¨ë“  ì¡°í•©ì„ ë§Œë“œì„¸ìš”.',
'- CROSS JOIN ì‚¬ìš©\n- ëª¨ë“  ê°€ëŠ¥í•œ ì¡°í•© ìƒì„±',
'[{"input": "", "output": "ì œí’ˆëª…, ìƒ‰ìƒ ëª¨ë“  ì¡°í•©"}]',
'-- productsì™€ colorsë¥¼ CROSS JOINí•˜ì„¸ìš”\n',
'SELECT p.product_name, c.color_name\nFROM products p\nCROSS JOIN colors c;',
'[{"input": "", "expected": "all combinations"}]',
'["CROSS JOINì€ ON ì¡°ê±´ ì—†ì´ ëª¨ë“  ì¡°í•©ì„ ë§Œë“­ë‹ˆë‹¤"]',
ARRAY['join', 'cross-join'], 10),

('sql-multiple-join', 'sql', 'syntax', 55, 'ë‹¤ì¤‘ í…Œì´ë¸” ì¡°ì¸', '3ê°œ ì´ìƒ í…Œì´ë¸” ì¡°ì¸', 'challenge', 2,
'orders, customers, products í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ ì£¼ë¬¸ ì •ë³´ë¥¼ ìƒì„¸íˆ ì¡°íšŒí•˜ì„¸ìš”.',
'- 3ê°œ í…Œì´ë¸”ì„ ìˆœì°¨ì ìœ¼ë¡œ JOIN\n- ê³ ê°ëª…, ì œí’ˆëª…, ì£¼ë¬¸ì¼ ì¶œë ¥',
'[{"input": "", "output": "ê³ ê°ëª…, ì œí’ˆëª…, ì£¼ë¬¸ì¼"}]',
'-- orders, customers, productsë¥¼ ì¡°ì¸í•˜ì„¸ìš”\n',
'SELECT c.customer_name, p.product_name, o.order_date\nFROM orders o\nJOIN customers c ON o.customer_id = c.customer_id\nJOIN products p ON o.product_id = p.product_id;',
'[{"input": "", "expected": "detailed order info"}]',
'["ì²« ë²ˆì§¸ JOIN ê²°ê³¼ì— ë‹¤ì‹œ JOINì„ ì¶”ê°€í•˜ì„¸ìš”"]',
ARRAY['join', 'multiple-tables'], 12);

-- Unit 12: ê³ ê¸‰ ì„œë¸Œì¿¼ë¦¬ (5 problems - MEDIUM)
INSERT INTO challenges_sql (slug, language, kind, level, title, description, category, difficulty, problem_description, constraints, examples, initial_code, solution_code, test_cases, hints, tags, estimated_time) VALUES
('sql-correlated-subquery', 'sql', 'syntax', 56, 'ìƒê´€ ì„œë¸Œì¿¼ë¦¬', 'ì™¸ë¶€ ì¿¼ë¦¬ì™€ ì—°ê´€ëœ ì„œë¸Œì¿¼ë¦¬', 'challenge', 2,
'ê° ë¶€ì„œë³„ë¡œ í‰ê·  ê¸‰ì—¬ë³´ë‹¤ ë†’ì€ ê¸‰ì—¬ë¥¼ ë°›ëŠ” ì§ì›ì„ ì¡°íšŒí•˜ì„¸ìš”.',
'- ìƒê´€ ì„œë¸Œì¿¼ë¦¬ ì‚¬ìš©\n- ì™¸ë¶€ ì¿¼ë¦¬ì˜ dept_idë¥¼ ì„œë¸Œì¿¼ë¦¬ì—ì„œ ì°¸ì¡°',
'[{"input": "", "output": "ì§ì›ëª…, ê¸‰ì—¬, ë¶€ì„œID"}]',
'-- ë¶€ì„œë³„ í‰ê· ë³´ë‹¤ ë†’ì€ ê¸‰ì—¬ë¥¼ ë°›ëŠ” ì§ì› ì¡°íšŒ\n',
'SELECT emp_name, salary, dept_id\nFROM employees e1\nWHERE salary > (SELECT AVG(salary) FROM employees e2 WHERE e2.dept_id = e1.dept_id);',
'[{"input": "", "expected": "employees above dept average"}]',
'["ì„œë¸Œì¿¼ë¦¬ì—ì„œ ì™¸ë¶€ í…Œì´ë¸”ì˜ ì»¬ëŸ¼ì„ ì°¸ì¡°í•˜ì„¸ìš”"]',
ARRAY['subquery', 'correlated'], 15),

('sql-exists-not-exists', 'sql', 'syntax', 57, 'EXISTSì™€ NOT EXISTS', 'ì¡´ì¬ ì—¬ë¶€ í™•ì¸', 'challenge', 2,
'ì£¼ë¬¸ì´ í•œ ë²ˆì´ë¼ë„ ìˆëŠ” ê³ ê°ë§Œ ì¡°íšŒí•˜ì„¸ìš”.',
'- EXISTS ì‚¬ìš©\n- ì„œë¸Œì¿¼ë¦¬ì—ì„œ orders í…Œì´ë¸” í™•ì¸',
'[{"input": "", "output": "ê³ ê°ëª…"}]',
'-- ì£¼ë¬¸ì´ ìˆëŠ” ê³ ê°ì„ EXISTSë¡œ ì¡°íšŒí•˜ì„¸ìš”\n',
'SELECT customer_name\nFROM customers c\nWHERE EXISTS (SELECT 1 FROM orders o WHERE o.customer_id = c.customer_id);',
'[{"input": "", "expected": "customers with orders"}]',
'["EXISTSëŠ” ê²°ê³¼ê°€ í•˜ë‚˜ë¼ë„ ìˆìœ¼ë©´ TRUEë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤"]',
ARRAY['subquery', 'exists'], 12),

('sql-any-all', 'sql', 'syntax', 58, 'ANYì™€ ALL ì—°ì‚°ì', 'ì„œë¸Œì¿¼ë¦¬ ê²°ê³¼ì™€ ë¹„êµ', 'challenge', 2,
'ì˜ì—…ë¶€ì„œì˜ ì–´ë–¤ ì§ì›ë³´ë‹¤ë„ ê¸‰ì—¬ê°€ ë†’ì€ ë‹¤ë¥¸ ë¶€ì„œ ì§ì›ì„ ì¡°íšŒí•˜ì„¸ìš”.',
'- ALL ì—°ì‚°ì ì‚¬ìš©\n- ì„œë¸Œì¿¼ë¦¬ë¡œ ì˜ì—…ë¶€ ê¸‰ì—¬ ì¡°íšŒ',
'[{"input": "", "output": "ì§ì›ëª…, ê¸‰ì—¬"}]',
'-- ì˜ì—…ë¶€ ëª¨ë“  ì§ì›ë³´ë‹¤ ê¸‰ì—¬ê°€ ë†’ì€ ì§ì› ì¡°íšŒ\n',
'SELECT emp_name, salary\nFROM employees\nWHERE salary > ALL (SELECT salary FROM employees WHERE dept_name = \'ì˜ì—…ë¶€\');',
'[{"input": "", "expected": "employees with higher salary"}]',
'["ALLì€ ì„œë¸Œì¿¼ë¦¬ì˜ ëª¨ë“  ê°’ë³´ë‹¤ ì»¤ì•¼ í•©ë‹ˆë‹¤"]',
ARRAY['subquery', 'all'], 12),

('sql-scalar-subquery', 'sql', 'syntax', 59, 'ìŠ¤ì¹¼ë¼ ì„œë¸Œì¿¼ë¦¬', 'SELECTì ˆì˜ ì„œë¸Œì¿¼ë¦¬', 'challenge', 2,
'ì§ì› ì •ë³´ì™€ í•¨ê»˜ ê·¸ ì§ì›ì˜ ë¶€ì„œ í‰ê·  ê¸‰ì—¬ë¥¼ í•¨ê»˜ ì¶œë ¥í•˜ì„¸ìš”.',
'- SELECTì ˆì— ì„œë¸Œì¿¼ë¦¬ ì‚¬ìš©\n- ë‹¨ì¼ ê°’ ë°˜í™˜',
'[{"input": "", "output": "ì§ì›ëª…, ê¸‰ì—¬, ë¶€ì„œí‰ê· ê¸‰ì—¬"}]',
'-- SELECTì ˆì— ì„œë¸Œì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”\n',
'SELECT emp_name, salary,\n  (SELECT AVG(salary) FROM employees e2 WHERE e2.dept_id = e1.dept_id) AS dept_avg\nFROM employees e1;',
'[{"input": "", "expected": "employees with dept average"}]',
'["SELECTì ˆì˜ ì„œë¸Œì¿¼ë¦¬ëŠ” í•˜ë‚˜ì˜ ê°’ë§Œ ë°˜í™˜í•´ì•¼ í•©ë‹ˆë‹¤"]',
ARRAY['subquery', 'scalar'], 15),

('sql-derived-table', 'sql', 'syntax', 60, 'íŒŒìƒ í…Œì´ë¸”', 'FROMì ˆì˜ ì„œë¸Œì¿¼ë¦¬', 'challenge', 2,
'ë¶€ì„œë³„ í‰ê·  ê¸‰ì—¬ë¥¼ êµ¬í•œ í›„, ê·¸ ì¤‘ 500ë§Œì› ì´ìƒì¸ ë¶€ì„œë§Œ ì¡°íšŒí•˜ì„¸ìš”.',
'- FROMì ˆì— ì„œë¸Œì¿¼ë¦¬ ì‚¬ìš©\n- ì„œë¸Œì¿¼ë¦¬ì— ë³„ì¹­ ë¶€ì—¬',
'[{"input": "", "output": "ë¶€ì„œID, í‰ê· ê¸‰ì—¬"}]',
'-- FROMì ˆì— ì„œë¸Œì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”\n',
'SELECT dept_id, avg_salary\nFROM (SELECT dept_id, AVG(salary) AS avg_salary FROM employees GROUP BY dept_id) AS dept_avg\nWHERE avg_salary >= 5000000;',
'[{"input": "", "expected": "high average salary depts"}]',
'["FROMì ˆì˜ ì„œë¸Œì¿¼ë¦¬ëŠ” ë°˜ë“œì‹œ ë³„ì¹­ì„ ê°€ì ¸ì•¼ í•©ë‹ˆë‹¤"]',
ARRAY['subquery', 'derived-table'], 15);

-- Unit 13: ì§‘í•© ì—°ì‚° (5 problems - MEDIUM)
INSERT INTO challenges_sql (slug, language, kind, level, title, description, category, difficulty, problem_description, constraints, examples, initial_code, solution_code, test_cases, hints, tags, estimated_time) VALUES
('sql-union', 'sql', 'syntax', 61, 'UNION ì‚¬ìš©', 'ì¤‘ë³µ ì œê±° í•©ì§‘í•©', 'challenge', 2,
'2023ë…„ ì£¼ë¬¸ê³¼ 2024ë…„ ì£¼ë¬¸ì˜ ê³ ê° ëª©ë¡ì„ ì¤‘ë³µ ì—†ì´ ì¡°íšŒí•˜ì„¸ìš”.',
'- UNION ì‚¬ìš©\n- ì¤‘ë³µ ìë™ ì œê±°',
'[{"input": "", "output": "ê³ ê°ID (ì¤‘ë³µ ì œê±°)"}]',
'-- 2023ë…„ê³¼ 2024ë…„ ì£¼ë¬¸ ê³ ê°ì„ UNIONìœ¼ë¡œ ì¡°íšŒ\n',
'SELECT customer_id FROM orders WHERE YEAR(order_date) = 2023\nUNION\nSELECT customer_id FROM orders WHERE YEAR(order_date) = 2024;',
'[{"input": "", "expected": "unique customers"}]',
'["UNIONì€ ìë™ìœ¼ë¡œ ì¤‘ë³µì„ ì œê±°í•©ë‹ˆë‹¤"]',
ARRAY['set-operations', 'union'], 10),

('sql-union-all', 'sql', 'syntax', 62, 'UNION ALL', 'ì¤‘ë³µ í¬í•¨ í•©ì§‘í•©', 'challenge', 2,
'ëª¨ë“  ì œí’ˆê³¼ ëª¨ë“  ì„œë¹„ìŠ¤ì˜ ì´ë¦„ì„ ì¤‘ë³µ í¬í•¨í•˜ì—¬ ì¡°íšŒí•˜ì„¸ìš”.',
'- UNION ALL ì‚¬ìš©\n- ì¤‘ë³µ ìœ ì§€',
'[{"input": "", "output": "ì´ë¦„ (ì¤‘ë³µ í¬í•¨)"}]',
'-- productsì™€ servicesì˜ ì´ë¦„ì„ UNION ALLë¡œ ì¡°íšŒ\n',
'SELECT product_name AS name FROM products\nUNION ALL\nSELECT service_name AS name FROM services;',
'[{"input": "", "expected": "all names with duplicates"}]',
'["UNION ALLì€ ì¤‘ë³µì„ ì œê±°í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤"]',
ARRAY['set-operations', 'union-all'], 10),

('sql-intersect', 'sql', 'syntax', 63, 'INTERSECT ì‚¬ìš©', 'êµì§‘í•©', 'challenge', 2,
'2023ë…„ê³¼ 2024ë…„ ëª¨ë‘ ì£¼ë¬¸í•œ ê³ ê°ì„ ì¡°íšŒí•˜ì„¸ìš”.',
'- INTERSECT ì‚¬ìš©\n- ì–‘ìª½ì— ëª¨ë‘ ì¡´ì¬í•˜ëŠ” í–‰',
'[{"input": "", "output": "ê³ ê°ID"}]',
'-- 2023ë…„ê³¼ 2024ë…„ ëª¨ë‘ ì£¼ë¬¸í•œ ê³ ê°ì„ INTERSECTë¡œ ì¡°íšŒ\n',
'SELECT customer_id FROM orders WHERE YEAR(order_date) = 2023\nINTERSECT\nSELECT customer_id FROM orders WHERE YEAR(order_date) = 2024;',
'[{"input": "", "expected": "customers in both years"}]',
'["INTERSECTëŠ” ì–‘ìª½ì— ëª¨ë‘ ìˆëŠ” í–‰ë§Œ ë°˜í™˜í•©ë‹ˆë‹¤"]',
ARRAY['set-operations', 'intersect'], 12),

('sql-except', 'sql', 'syntax', 64, 'EXCEPT/MINUS', 'ì°¨ì§‘í•©', 'challenge', 2,
'2023ë…„ì—ëŠ” ì£¼ë¬¸í–ˆì§€ë§Œ 2024ë…„ì—ëŠ” ì£¼ë¬¸í•˜ì§€ ì•Šì€ ê³ ê°ì„ ì¡°íšŒí•˜ì„¸ìš”.',
'- EXCEPT ë˜ëŠ” MINUS ì‚¬ìš©\n- ì²« ë²ˆì§¸ ì§‘í•©ì—ë§Œ ìˆëŠ” í–‰',
'[{"input": "", "output": "ê³ ê°ID"}]',
'-- 2023ë…„ì—ë§Œ ì£¼ë¬¸í•œ ê³ ê°ì„ EXCEPTë¡œ ì¡°íšŒ\n',
'SELECT customer_id FROM orders WHERE YEAR(order_date) = 2023\nEXCEPT\nSELECT customer_id FROM orders WHERE YEAR(order_date) = 2024;',
'[{"input": "", "expected": "customers only in 2023"}]',
'["EXCEPTëŠ” ì²« ë²ˆì§¸ ì§‘í•©ì—ì„œ ë‘ ë²ˆì§¸ ì§‘í•©ì„ ëºë‹ˆë‹¤"]',
ARRAY['set-operations', 'except'], 12),

('sql-set-operations-complex', 'sql', 'syntax', 65, 'ë³µí•© ì§‘í•© ì—°ì‚°', 'ì—¬ëŸ¬ ì§‘í•© ì—°ì‚° ì¡°í•©', 'challenge', 2,
'(A UNION B) INTERSECT C í˜•íƒœì˜ ë³µí•© ì§‘í•© ì—°ì‚°ì„ ìˆ˜í–‰í•˜ì„¸ìš”.',
'- ê´„í˜¸ë¡œ ì—°ì‚° ìˆœì„œ ì§€ì •\n- ì—¬ëŸ¬ ì§‘í•© ì—°ì‚° ì¡°í•©',
'[{"input": "", "output": "ê²°ê³¼ ì§‘í•©"}]',
'-- ë³µí•© ì§‘í•© ì—°ì‚°ì„ ìˆ˜í–‰í•˜ì„¸ìš”\n',
'(SELECT id FROM table_a UNION SELECT id FROM table_b)\nINTERSECT\nSELECT id FROM table_c;',
'[{"input": "", "expected": "complex set result"}]',
'["ê´„í˜¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—°ì‚° ìˆœì„œë¥¼ ì§€ì •í•˜ì„¸ìš”"]',
ARRAY['set-operations', 'complex'], 15);

-- Unit 14: ìœˆë„ìš° í•¨ìˆ˜ (5 problems - MEDIUM)
INSERT INTO challenges_sql (slug, language, kind, level, title, description, category, difficulty, problem_description, constraints, examples, initial_code, solution_code, test_cases, hints, tags, estimated_time) VALUES
('sql-row-number', 'sql', 'syntax', 66, 'ROW_NUMBER í•¨ìˆ˜', 'í–‰ ë²ˆí˜¸ ë¶€ì—¬', 'challenge', 2,
'ê° ë¶€ì„œë³„ë¡œ ê¸‰ì—¬ ìˆœìœ¼ë¡œ ìˆœìœ„ë¥¼ ë§¤ê¸°ì„¸ìš”.',
'- ROW_NUMBER() OVER ì‚¬ìš©\n- PARTITION BYì™€ ORDER BY',
'[{"input": "", "output": "ì§ì›ëª…, ë¶€ì„œ, ê¸‰ì—¬, ìˆœìœ„"}]',
'-- ROW_NUMBERë¡œ ë¶€ì„œë³„ ê¸‰ì—¬ ìˆœìœ„ë¥¼ ë§¤ê¸°ì„¸ìš”\n',
'SELECT emp_name, dept_id, salary,\n  ROW_NUMBER() OVER (PARTITION BY dept_id ORDER BY salary DESC) AS rank\nFROM employees;',
'[{"input": "", "expected": "ranked employees"}]',
'["PARTITION BYë¡œ ê·¸ë£¹ì„ ë‚˜ëˆ„ê³  ORDER BYë¡œ ì •ë ¬í•˜ì„¸ìš”"]',
ARRAY['window-function', 'row-number'], 15),

('sql-rank-dense-rank', 'sql', 'syntax', 67, 'RANKì™€ DENSE_RANK', 'ìˆœìœ„ í•¨ìˆ˜', 'challenge', 2,
'ì „ì²´ ì§ì›ì˜ ê¸‰ì—¬ ìˆœìœ„ë¥¼ RANKì™€ DENSE_RANKë¡œ ê°ê° êµ¬í•˜ì„¸ìš”.',
'- RANK()ì™€ DENSE_RANK() ë¹„êµ\n- ë™ì  ì²˜ë¦¬ ë°©ì‹ ì°¨ì´',
'[{"input": "", "output": "ì§ì›ëª…, ê¸‰ì—¬, rank, dense_rank"}]',
'-- RANKì™€ DENSE_RANKë¡œ ê¸‰ì—¬ ìˆœìœ„ë¥¼ êµ¬í•˜ì„¸ìš”\n',
'SELECT emp_name, salary,\n  RANK() OVER (ORDER BY salary DESC) AS rank,\n  DENSE_RANK() OVER (ORDER BY salary DESC) AS dense_rank\nFROM employees;',
'[{"input": "", "expected": "ranks comparison"}]',
'["RANKëŠ” ë™ì  ì‹œ ë‹¤ìŒ ìˆœìœ„ë¥¼ ê±´ë„ˆë›°ê³ , DENSE_RANKëŠ” ê±´ë„ˆë›°ì§€ ì•ŠìŠµë‹ˆë‹¤"]',
ARRAY['window-function', 'rank'], 15),

('sql-lag-lead', 'sql', 'syntax', 68, 'LAGì™€ LEAD', 'ì´ì „/ë‹¤ìŒ í–‰ ì°¸ì¡°', 'challenge', 2,
'ê° ì§ì›ì˜ ê¸‰ì—¬ì™€ ì´ì „ ì§ì›ì˜ ê¸‰ì—¬ë¥¼ í•¨ê»˜ ì¶œë ¥í•˜ì„¸ìš”.',
'- LAG() í•¨ìˆ˜ ì‚¬ìš©\n- ì •ë ¬ ìˆœì„œì— ë”°ë¥¸ ì´ì „ ê°’ ì°¸ì¡°',
'[{"input": "", "output": "ì§ì›ëª…, ê¸‰ì—¬, ì´ì „ê¸‰ì—¬"}]',
'-- LAGë¡œ ì´ì „ ì§ì›ì˜ ê¸‰ì—¬ë¥¼ ì¡°íšŒí•˜ì„¸ìš”\n',
'SELECT emp_name, salary,\n  LAG(salary) OVER (ORDER BY emp_id) AS prev_salary\nFROM employees;',
'[{"input": "", "expected": "salary with previous"}]',
'["LAGëŠ” ì´ì „ í–‰, LEADëŠ” ë‹¤ìŒ í–‰ì„ ì°¸ì¡°í•©ë‹ˆë‹¤"]',
ARRAY['window-function', 'lag-lead'], 15),

('sql-sum-over', 'sql', 'syntax', 69, 'ëˆ„ì  í•©ê³„', 'SUM OVER ìœˆë„ìš° í•¨ìˆ˜', 'challenge', 2,
'ë‚ ì§œë³„ ë§¤ì¶œì˜ ëˆ„ì  í•©ê³„ë¥¼ êµ¬í•˜ì„¸ìš”.',
'- SUM() OVER ì‚¬ìš©\n- ROWS BETWEENìœ¼ë¡œ ë²”ìœ„ ì§€ì •',
'[{"input": "", "output": "ë‚ ì§œ, ë§¤ì¶œ, ëˆ„ì í•©ê³„"}]',
'-- ë‚ ì§œë³„ ë§¤ì¶œì˜ ëˆ„ì  í•©ê³„ë¥¼ êµ¬í•˜ì„¸ìš”\n',
'SELECT sale_date, amount,\n  SUM(amount) OVER (ORDER BY sale_date ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cumulative_sum\nFROM sales;',
'[{"input": "", "expected": "cumulative sales"}]',
'["ROWS BETWEENìœ¼ë¡œ ì²« í–‰ë¶€í„° í˜„ì¬ í–‰ê¹Œì§€ í•©ê³„ë¥¼ êµ¬í•˜ì„¸ìš”"]',
ARRAY['window-function', 'sum-over'], 15),

('sql-ntile', 'sql', 'syntax', 70, 'NTILE í•¨ìˆ˜', 'ê·¸ë£¹ ë¶„í• ', 'challenge', 2,
'ì§ì›ì„ ê¸‰ì—¬ ê¸°ì¤€ìœ¼ë¡œ 4ê°œ ê·¸ë£¹(ì‚¬ë¶„ìœ„)ìœ¼ë¡œ ë‚˜ëˆ„ì„¸ìš”.',
'- NTILE(4) ì‚¬ìš©\n- ê· ë“± ë¶„í• ',
'[{"input": "", "output": "ì§ì›ëª…, ê¸‰ì—¬, ì‚¬ë¶„ìœ„"}]',
'-- NTILEë¡œ ì§ì›ì„ 4ê°œ ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆ„ì„¸ìš”\n',
'SELECT emp_name, salary,\n  NTILE(4) OVER (ORDER BY salary DESC) AS quartile\nFROM employees;',
'[{"input": "", "expected": "employees in quartiles"}]',
'["NTILE(n)ì€ ë°ì´í„°ë¥¼ nê°œì˜ ê· ë“±í•œ ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆ•ë‹ˆë‹¤"]',
ARRAY['window-function', 'ntile'], 12);

-- Unit 15: CTEì™€ ì¬ê·€ ì¿¼ë¦¬ (5 problems - MEDIUM)
INSERT INTO challenges_sql (slug, language, kind, level, title, description, category, difficulty, problem_description, constraints, examples, initial_code, solution_code, test_cases, hints, tags, estimated_time) VALUES
('sql-simple-cte', 'sql', 'syntax', 71, 'ê¸°ë³¸ CTE', 'WITH ì ˆ ì‚¬ìš©', 'challenge', 2,
'WITH ì ˆì„ ì‚¬ìš©í•˜ì—¬ ë¶€ì„œë³„ í‰ê·  ê¸‰ì—¬ë¥¼ êµ¬í•˜ê³ , ê·¸ ê²°ê³¼ë¥¼ ë‹¤ì‹œ ì‚¬ìš©í•˜ì„¸ìš”.',
'- WITH ... AS (...) ì‚¬ìš©\n- CTEë¥¼ SELECTì—ì„œ ì°¸ì¡°',
'[{"input": "", "output": "ë¶€ì„œID, í‰ê· ê¸‰ì—¬"}]',
'-- WITH ì ˆë¡œ CTEë¥¼ ë§Œë“œì„¸ìš”\n',
'WITH dept_avg AS (\n  SELECT dept_id, AVG(salary) AS avg_salary\n  FROM employees\n  GROUP BY dept_id\n)\nSELECT * FROM dept_avg WHERE avg_salary >= 5000000;',
'[{"input": "", "expected": "high average depts"}]',
'["WITHë¡œ ì„ì‹œ ê²°ê³¼ë¥¼ ë§Œë“¤ê³  ì´ë¦„ì„ ë¶€ì—¬í•˜ì„¸ìš”"]',
ARRAY['cte', 'with'], 12),

('sql-multiple-cte', 'sql', 'syntax', 72, 'ë‹¤ì¤‘ CTE', 'ì—¬ëŸ¬ CTE ì •ì˜', 'challenge', 2,
'2ê°œì˜ CTEë¥¼ ì •ì˜í•˜ê³  ì¡°ì¸í•˜ì—¬ ì‚¬ìš©í•˜ì„¸ìš”.',
'- WITH cte1 AS (...), cte2 AS (...)\n- CTEë¼ë¦¬ ì¡°ì¸',
'[{"input": "", "output": "ì¡°ì¸ ê²°ê³¼"}]',
'-- ì—¬ëŸ¬ CTEë¥¼ ì •ì˜í•˜ê³  ì¡°ì¸í•˜ì„¸ìš”\n',
'WITH high_salary AS (\n  SELECT emp_id, emp_name FROM employees WHERE salary > 5000000\n),\ndept_info AS (\n  SELECT dept_id, dept_name FROM departments\n)\nSELECT h.emp_name, d.dept_name\nFROM high_salary h\nJOIN employees e ON h.emp_id = e.emp_id\nJOIN dept_info d ON e.dept_id = d.dept_id;',
'[{"input": "", "expected": "joined cte result"}]',
'["ì—¬ëŸ¬ CTEëŠ” ì‰¼í‘œë¡œ êµ¬ë¶„í•˜ì—¬ ì •ì˜í•©ë‹ˆë‹¤"]',
ARRAY['cte', 'multiple'], 15),

('sql-recursive-cte', 'sql', 'syntax', 73, 'ì¬ê·€ CTE', 'ê³„ì¸µ êµ¬ì¡° ì¡°íšŒ', 'challenge', 2,
'ì¬ê·€ CTEë¥¼ ì‚¬ìš©í•˜ì—¬ 1ë¶€í„° 10ê¹Œì§€ ìˆ«ìë¥¼ ìƒì„±í•˜ì„¸ìš”.',
'- WITH RECURSIVE ì‚¬ìš©\n- UNION ALLë¡œ ì¬ê·€ í˜¸ì¶œ',
'[{"input": "", "output": "1ë¶€í„° 10ê¹Œì§€"}]',
'-- ì¬ê·€ CTEë¡œ 1ë¶€í„° 10ê¹Œì§€ ìƒì„±í•˜ì„¸ìš”\n',
'WITH RECURSIVE numbers AS (\n  SELECT 1 AS n\n  UNION ALL\n  SELECT n + 1 FROM numbers WHERE n < 10\n)\nSELECT * FROM numbers;',
'[{"input": "", "expected": "numbers 1 to 10"}]',
'["ê¸°ë³¸ ì¼€ì´ìŠ¤ì™€ ì¬ê·€ ì¼€ì´ìŠ¤ë¥¼ UNION ALLë¡œ ì—°ê²°í•˜ì„¸ìš”"]',
ARRAY['cte', 'recursive'], 18),

('sql-hierarchy-query', 'sql', 'syntax', 74, 'ì¡°ì§ë„ ì¡°íšŒ', 'ì¬ê·€ë¡œ ê³„ì¸µ êµ¬ì¡°', 'challenge', 2,
'ì¬ê·€ CTEë¡œ ì§ì›ì˜ ì „ì²´ ìƒìœ„ ê´€ë¦¬ì ì²´ì¸ì„ ì¡°íšŒí•˜ì„¸ìš”.',
'- ì§ì›-ë§¤ë‹ˆì € ê´€ê³„ë¥¼ ì¬ê·€ë¡œ íƒìƒ‰\n- ìµœìƒìœ„ê¹Œì§€ ì˜¬ë¼ê°€ê¸°',
'[{"input": "", "output": "ì§ì›ëª…, ë ˆë²¨, ê²½ë¡œ"}]',
'-- ì¬ê·€ CTEë¡œ ì¡°ì§ë„ë¥¼ ì¡°íšŒí•˜ì„¸ìš”\n',
'WITH RECURSIVE org_chart AS (\n  SELECT emp_id, emp_name, manager_id, 1 AS level\n  FROM employees\n  WHERE manager_id IS NULL\n  UNION ALL\n  SELECT e.emp_id, e.emp_name, e.manager_id, o.level + 1\n  FROM employees e\n  JOIN org_chart o ON e.manager_id = o.emp_id\n)\nSELECT * FROM org_chart;',
'[{"input": "", "expected": "org hierarchy"}]',
'["ìµœìƒìœ„(manager_id IS NULL)ë¶€í„° ì‹œì‘í•˜ì—¬ í•˜ìœ„ë¡œ ë‚´ë ¤ê°€ì„¸ìš”"]',
ARRAY['cte', 'hierarchy'], 20),

('sql-cte-update', 'sql', 'syntax', 75, 'CTEë¡œ UPDATE', 'CTEë¥¼ DMLì— ì‚¬ìš©', 'challenge', 2,
'CTEë¥¼ ì‚¬ìš©í•˜ì—¬ ë¶€ì„œ í‰ê· ë³´ë‹¤ ë‚®ì€ ê¸‰ì—¬ë¥¼ ê°€ì§„ ì§ì›ì˜ ê¸‰ì—¬ë¥¼ 10% ì¸ìƒí•˜ì„¸ìš”.',
'- WITH ì ˆ í›„ UPDATE ì‚¬ìš©\n- CTE ê²°ê³¼ë¥¼ WHERE ì ˆì—ì„œ ì°¸ì¡°',
'[{"input": "", "output": "ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜"}]',
'-- CTEë¡œ ëŒ€ìƒì„ ì •í•˜ê³  UPDATEí•˜ì„¸ìš”\n',
'WITH dept_avg AS (\n  SELECT dept_id, AVG(salary) AS avg_salary\n  FROM employees\n  GROUP BY dept_id\n)\nUPDATE employees e\nSET salary = salary * 1.1\nFROM dept_avg d\nWHERE e.dept_id = d.dept_id AND e.salary < d.avg_salary;',
'[{"input": "", "expected": "updated rows"}]',
'["CTE ê²°ê³¼ë¥¼ UPDATEì˜ FROM ì ˆì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"]',
ARRAY['cte', 'update'], 15);

-- Unit 16: CASE ë¬¸ê³¼ ì¡°ê±´ ë¡œì§ (5 problems - MEDIUM)
INSERT INTO challenges_sql (slug, language, kind, level, title, description, category, difficulty, problem_description, constraints, examples, initial_code, solution_code, test_cases, hints, tags, estimated_time) VALUES
('sql-simple-case', 'sql', 'syntax', 76, 'CASE WHEN ê¸°ë³¸', 'ì¡°ê±´ë¶€ ê°’ ë°˜í™˜', 'challenge', 2,
'ê¸‰ì—¬ êµ¬ê°„ì— ë”°ë¼ ë“±ê¸‰ì„ ë¶€ì—¬í•˜ì„¸ìš” (5ë°±ë§Œ ì´ìƒ: A, 3ë°±ë§Œ ì´ìƒ: B, ë‚˜ë¨¸ì§€: C).',
'- CASE WHEN ... THEN ... END\n- ì—¬ëŸ¬ ì¡°ê±´ ë¶„ê¸°',
'[{"input": "", "output": "ì§ì›ëª…, ê¸‰ì—¬, ë“±ê¸‰"}]',
'-- CASE WHENìœ¼ë¡œ ê¸‰ì—¬ ë“±ê¸‰ì„ ë¶€ì—¬í•˜ì„¸ìš”\n',
'SELECT emp_name, salary,\n  CASE\n    WHEN salary >= 5000000 THEN \'A\'\n    WHEN salary >= 3000000 THEN \'B\'\n    ELSE \'C\'\n  END AS grade\nFROM employees;',
'[{"input": "", "expected": "employees with grades"}]',
'["CASEëŠ” ìœ„ì—ì„œë¶€í„° ìˆœì„œëŒ€ë¡œ ì¡°ê±´ì„ í‰ê°€í•©ë‹ˆë‹¤"]',
ARRAY['case', 'conditional'], 12),

('sql-searched-case', 'sql', 'syntax', 77, 'Searched CASE', 'ë³µì¡í•œ ì¡°ê±´ ë¶„ê¸°', 'challenge', 2,
'ë¶€ì„œì™€ ê¸‰ì—¬ë¥¼ ë™ì‹œì— ê³ ë ¤í•œ ë³µí•© ë“±ê¸‰ì„ ë¶€ì—¬í•˜ì„¸ìš”.',
'- ì—¬ëŸ¬ ì»¬ëŸ¼ì„ ì¡°ê±´ìœ¼ë¡œ ì‚¬ìš©\n- AND/OR ì¡°í•©',
'[{"input": "", "output": "ì§ì›ëª…, ë¶€ì„œ, ê¸‰ì—¬, ë“±ê¸‰"}]',
'-- ë¶€ì„œì™€ ê¸‰ì—¬ë¥¼ í•¨ê»˜ ê³ ë ¤í•˜ì—¬ ë“±ê¸‰ì„ ë¶€ì—¬í•˜ì„¸ìš”\n',
'SELECT emp_name, dept_name, salary,\n  CASE\n    WHEN dept_name = \'ì˜ì—…ë¶€\' AND salary >= 5000000 THEN \'ì˜ì—…A\'\n    WHEN dept_name = \'ê°œë°œë¶€\' AND salary >= 6000000 THEN \'ê°œë°œA\'\n    WHEN salary >= 4000000 THEN \'ì¼ë°˜A\'\n    ELSE \'ì¼ë°˜B\'\n  END AS grade\nFROM employees;',
'[{"input": "", "expected": "complex grades"}]',
'["ANDë¡œ ì—¬ëŸ¬ ì¡°ê±´ì„ ê²°í•©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"]',
ARRAY['case', 'complex'], 15),

('sql-case-in-aggregate', 'sql', 'syntax', 78, 'ì§‘ê³„ í•¨ìˆ˜ì˜ CASE', 'ì¡°ê±´ë¶€ ì§‘ê³„', 'challenge', 2,
'ë¶€ì„œë³„ë¡œ ê³ ê¸‰ì—¬(500ë§Œ ì´ìƒ)ì™€ ì €ê¸‰ì—¬(500ë§Œ ë¯¸ë§Œ) ì§ì› ìˆ˜ë¥¼ ê°ê° êµ¬í•˜ì„¸ìš”.',
'- SUM(CASE ...) íŒ¨í„´\n- ì¡°ê±´ë¶€ ì¹´ìš´íŠ¸',
'[{"input": "", "output": "ë¶€ì„œ, ê³ ê¸‰ì—¬ìˆ˜, ì €ê¸‰ì—¬ìˆ˜"}]',
'-- CASEë¥¼ ì§‘ê³„ í•¨ìˆ˜ ì•ˆì—ì„œ ì‚¬ìš©í•˜ì„¸ìš”\n',
'SELECT dept_id,\n  SUM(CASE WHEN salary >= 5000000 THEN 1 ELSE 0 END) AS high_salary_count,\n  SUM(CASE WHEN salary < 5000000 THEN 1 ELSE 0 END) AS low_salary_count\nFROM employees\nGROUP BY dept_id;',
'[{"input": "", "expected": "conditional counts"}]',
'["CASEë¡œ ì¡°ê±´ì— ë§ìœ¼ë©´ 1, ì•„ë‹ˆë©´ 0ì„ ë°˜í™˜í•˜ì—¬ í•©ê³„ë¥¼ êµ¬í•˜ì„¸ìš”"]',
ARRAY['case', 'aggregate'], 15),

('sql-case-in-order-by', 'sql', 'syntax', 79, 'ORDER BYì˜ CASE', 'ì¡°ê±´ë¶€ ì •ë ¬', 'challenge', 2,
'ë¶€ì„œê°€ "ì˜ì—…ë¶€"ë©´ ê¸‰ì—¬ ë‚´ë¦¼ì°¨ìˆœ, ë‚˜ë¨¸ì§€ëŠ” ì´ë¦„ ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì •ë ¬í•˜ì„¸ìš”.',
'- ORDER BY CASE ...\n- ì¡°ê±´ì— ë”°ë¥¸ ì •ë ¬ ë°©ì‹ ë³€ê²½',
'[{"input": "", "output": "ì •ë ¬ëœ ì§ì› ëª©ë¡"}]',
'-- ORDER BYì— CASEë¥¼ ì‚¬ìš©í•˜ì„¸ìš”\n',
'SELECT emp_name, dept_name, salary\nFROM employees\nORDER BY\n  CASE WHEN dept_name = \'ì˜ì—…ë¶€\' THEN salary END DESC,\n  CASE WHEN dept_name != \'ì˜ì—…ë¶€\' THEN emp_name END ASC;',
'[{"input": "", "expected": "conditionally sorted"}]',
'["ORDER BYì— ì—¬ëŸ¬ CASEë¥¼ ì‚¬ìš©í•˜ì—¬ ì¡°ê±´ë³„ë¡œ ë‹¤ë¥¸ ì •ë ¬ì„ ì ìš©í•˜ì„¸ìš”"]',
ARRAY['case', 'order-by'], 15),

('sql-pivot-with-case', 'sql', 'syntax', 80, 'CASEë¡œ í”¼ë²—', 'í–‰ì„ ì—´ë¡œ ë³€í™˜', 'challenge', 2,
'ì›”ë³„ ë§¤ì¶œì„ ì—´ë¡œ í¼ì³ì„œ í‘œì‹œí•˜ì„¸ìš” (1ì›”, 2ì›”, 3ì›” ì»¬ëŸ¼).',
'- CASEë¡œ ì¡°ê±´ë¶€ ê°’ í• ë‹¹\n- ì§‘ê³„ í•¨ìˆ˜ì™€ í•¨ê»˜ ì‚¬ìš©',
'[{"input": "", "output": "ì œí’ˆ, 1ì›”, 2ì›”, 3ì›”"}]',
'-- CASEë¡œ ì›”ë³„ ë§¤ì¶œì„ í”¼ë²—í•˜ì„¸ìš”\n',
'SELECT product_id,\n  SUM(CASE WHEN MONTH(sale_date) = 1 THEN amount ELSE 0 END) AS jan,\n  SUM(CASE WHEN MONTH(sale_date) = 2 THEN amount ELSE 0 END) AS feb,\n  SUM(CASE WHEN MONTH(sale_date) = 3 THEN amount ELSE 0 END) AS mar\nFROM sales\nGROUP BY product_id;',
'[{"input": "", "expected": "pivoted sales"}]',
'["ê° ì›”ì— í•´ë‹¹í•˜ëŠ” CASEë¥¼ ë§Œë“¤ì–´ SUMìœ¼ë¡œ ì§‘ê³„í•˜ì„¸ìš”"]',
ARRAY['case', 'pivot'], 18);

-- Unit 17: ë¬¸ìì—´ í•¨ìˆ˜ (5 problems - HARD)
INSERT INTO challenges_sql (slug, language, kind, level, title, description, category, difficulty, problem_description, constraints, examples, initial_code, solution_code, test_cases, hints, tags, estimated_time) VALUES
('sql-string-manipulation', 'sql', 'syntax', 81, 'ë¬¸ìì—´ ê°€ê³µ', 'CONCAT, SUBSTRING ë“±', 'challenge', 3,
'ì´ë©”ì¼ ì£¼ì†Œì—ì„œ ë„ë©”ì¸ ë¶€ë¶„ë§Œ ì¶”ì¶œí•˜ê³ , ëŒ€ë¬¸ìë¡œ ë³€í™˜í•˜ì„¸ìš”.',
'- SUBSTRING, POSITION, UPPER ì‚¬ìš©\n- @ ì´í›„ ë¬¸ìì—´ ì¶”ì¶œ',
'[{"input": "", "output": "ì´ë©”ì¼, ë„ë©”ì¸"}]',
'-- ì´ë©”ì¼ì—ì„œ ë„ë©”ì¸ì„ ì¶”ì¶œí•˜ê³  ëŒ€ë¬¸ìë¡œ ë³€í™˜í•˜ì„¸ìš”\n',
'SELECT email,\n  UPPER(SUBSTRING(email FROM POSITION(\'@\' IN email) + 1)) AS domain\nFROM users;',
'[{"input": "", "expected": "extracted domains"}]',
'["POSITIONìœ¼ë¡œ @ì˜ ìœ„ì¹˜ë¥¼ ì°¾ê³ , SUBSTRINGìœ¼ë¡œ ê·¸ ì´í›„ë¥¼ ì¶”ì¶œí•˜ì„¸ìš”"]',
ARRAY['string-function', 'hard'], 20),

('sql-pattern-matching', 'sql', 'syntax', 82, 'íŒ¨í„´ ë§¤ì¹­', 'LIKE, REGEXP', 'challenge', 3,
'ì „í™”ë²ˆí˜¸ í˜•ì‹ì´ ì˜¬ë°”ë¥¸ì§€ ê²€ì¦í•˜ì„¸ìš” (###-####-####).',
'- REGEXP ë˜ëŠ” ì •ê·œì‹ ì‚¬ìš©\n- íŒ¨í„´ ì¼ì¹˜ í™•ì¸',
'[{"input": "", "output": "ì´ë¦„, ì „í™”ë²ˆí˜¸, ìœ íš¨ì„±"}]',
'-- ì „í™”ë²ˆí˜¸ê°€ íŒ¨í„´ì— ë§ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”\n',
'SELECT name, phone,\n  CASE\n    WHEN phone ~ \'^[0-9]{3}-[0-9]{4}-[0-9]{4}$\' THEN \'ìœ íš¨\'\n    ELSE \'ë¬´íš¨\'\n  END AS validity\nFROM users;',
'[{"input": "", "expected": "validated phones"}]',
'["ì •ê·œì‹ ~ë¥¼ ì‚¬ìš©í•˜ì—¬ íŒ¨í„´ì„ ê²€ì¦í•˜ì„¸ìš”"]',
ARRAY['string-function', 'regexp', 'hard'], 20),

('sql-string-aggregation', 'sql', 'syntax', 83, 'ë¬¸ìì—´ ì§‘ê³„', 'STRING_AGG, GROUP_CONCAT', 'challenge', 3,
'ë¶€ì„œë³„ë¡œ ì§ì› ì´ë¦„ì„ ì‰¼í‘œë¡œ ì—°ê²°í•˜ì—¬ í•˜ë‚˜ì˜ ë¬¸ìì—´ë¡œ ë§Œë“œì„¸ìš”.',
'- STRING_AGG ë˜ëŠ” GROUP_CONCAT\n- êµ¬ë¶„ì ì§€ì •',
'[{"input": "", "output": "ë¶€ì„œ, ì§ì›ëª©ë¡"}]',
'-- STRING_AGGë¡œ ì§ì› ì´ë¦„ì„ ì—°ê²°í•˜ì„¸ìš”\n',
'SELECT dept_id,\n  STRING_AGG(emp_name, \', \' ORDER BY emp_name) AS employees\nFROM employees\nGROUP BY dept_id;',
'[{"input": "", "expected": "concatenated names"}]',
'["STRING_AGG(ì»¬ëŸ¼, êµ¬ë¶„ì)ë¡œ ê·¸ë£¹ì˜ ê°’ë“¤ì„ ì—°ê²°í•˜ì„¸ìš”"]',
ARRAY['string-function', 'aggregation', 'hard'], 18),

('sql-split-string', 'sql', 'syntax', 84, 'ë¬¸ìì—´ ë¶„ë¦¬', 'SPLIT_PART, UNNEST', 'challenge', 3,
'ì‰¼í‘œë¡œ êµ¬ë¶„ëœ íƒœê·¸ ë¬¸ìì—´ì„ ê°œë³„ í–‰ìœ¼ë¡œ ë¶„ë¦¬í•˜ì„¸ìš”.',
'- STRING_TO_ARRAY, UNNEST ì‚¬ìš©\n- í•˜ë‚˜ì˜ í–‰ì„ ì—¬ëŸ¬ í–‰ìœ¼ë¡œ í™•ì¥',
'[{"input": "", "output": "ID, ê°œë³„íƒœê·¸"}]',
'-- íƒœê·¸ ë¬¸ìì—´ì„ ê°œë³„ í–‰ìœ¼ë¡œ ë¶„ë¦¬í•˜ì„¸ìš”\n',
'SELECT id, UNNEST(STRING_TO_ARRAY(tags, \',\')) AS tag\nFROM posts;',
'[{"input": "", "expected": "split tags"}]',
'["STRING_TO_ARRAYë¡œ ë°°ì—´ì„ ë§Œë“¤ê³  UNNESTë¡œ í–‰ìœ¼ë¡œ í™•ì¥í•˜ì„¸ìš”"]',
ARRAY['string-function', 'split', 'hard'], 20),

('sql-levenshtein-distance', 'sql', 'syntax', 85, 'ìœ ì‚¬ ë¬¸ìì—´ ì°¾ê¸°', 'í¸ì§‘ ê±°ë¦¬ ê³„ì‚°', 'challenge', 3,
'Levenshtein ê±°ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ë¦„ì´ ìœ ì‚¬í•œ ê³ ê°ì„ ì°¾ìœ¼ì„¸ìš”.',
'- LEVENSHTEIN í•¨ìˆ˜ ë˜ëŠ” ìœ ì‚¬ë„ í•¨ìˆ˜\n- ê±°ë¦¬ 3 ì´ë‚´',
'[{"input": "", "output": "ê³ ê°1, ê³ ê°2, ê±°ë¦¬"}]',
'-- ìœ ì‚¬í•œ ì´ë¦„ì„ ê°€ì§„ ê³ ê° ìŒì„ ì°¾ìœ¼ì„¸ìš”\n',
'SELECT c1.name AS name1, c2.name AS name2,\n  LEVENSHTEIN(c1.name, c2.name) AS distance\nFROM customers c1\nJOIN customers c2 ON c1.id < c2.id\nWHERE LEVENSHTEIN(c1.name, c2.name) <= 3;',
'[{"input": "", "expected": "similar name pairs"}]',
'["LEVENSHTEIN í•¨ìˆ˜ë¡œ ë‘ ë¬¸ìì—´ ê°„ í¸ì§‘ ê±°ë¦¬ë¥¼ ê³„ì‚°í•˜ì„¸ìš”"]',
ARRAY['string-function', 'similarity', 'hard'], 25);

-- Unit 18: ë‚ ì§œ/ì‹œê°„ í•¨ìˆ˜ (5 problems - HARD)
INSERT INTO challenges_sql (slug, language, kind, level, title, description, category, difficulty, problem_description, constraints, examples, initial_code, solution_code, test_cases, hints, tags, estimated_time) VALUES
('sql-date-calculation', 'sql', 'syntax', 86, 'ë‚ ì§œ ê³„ì‚°', 'ë‚ ì§œ ì—°ì‚°', 'challenge', 3,
'ê° ì£¼ë¬¸ì¼ë¡œë¶€í„° 30ì¼ í›„ ë‚ ì§œì™€ ë‚¨ì€ ì¼ìˆ˜ë¥¼ ê³„ì‚°í•˜ì„¸ìš”.',
'- DATE_ADD, DATEDIFF ì‚¬ìš©\n- CURRENT_DATEì™€ ë¹„êµ',
'[{"input": "", "output": "ì£¼ë¬¸ì¼, ë§Œë£Œì¼, ë‚¨ì€ì¼ìˆ˜"}]',
'-- ì£¼ë¬¸ì¼ë¡œë¶€í„° 30ì¼ í›„ì™€ ë‚¨ì€ ì¼ìˆ˜ë¥¼ ê³„ì‚°í•˜ì„¸ìš”\n',
'SELECT order_date,\n  order_date + INTERVAL \'30 days\' AS expiry_date,\n  (order_date + INTERVAL \'30 days\') - CURRENT_DATE AS days_left\nFROM orders;',
'[{"input": "", "expected": "date calculations"}]',
'["INTERVALë¡œ ë‚ ì§œì— ì¼ìˆ˜ë¥¼ ë”í•˜ê³ , ë‚ ì§œë¼ë¦¬ ë¹¼ì„œ ì°¨ì´ë¥¼ êµ¬í•˜ì„¸ìš”"]',
ARRAY['date-function', 'hard'], 18),

('sql-extract-date-parts', 'sql', 'syntax', 87, 'ë‚ ì§œ ë¶€ë¶„ ì¶”ì¶œ', 'EXTRACT, DATE_PART', 'challenge', 3,
'ì£¼ë¬¸ ë‚ ì§œì—ì„œ ë…„, ì›”, ìš”ì¼, ì£¼ì°¨ë¥¼ ê°ê° ì¶”ì¶œí•˜ì„¸ìš”.',
'- EXTRACT ë˜ëŠ” DATE_PART ì‚¬ìš©\n- YEAR, MONTH, DOW, WEEK',
'[{"input": "", "output": "ì£¼ë¬¸ì¼, ë…„, ì›”, ìš”ì¼, ì£¼ì°¨"}]',
'-- ë‚ ì§œì—ì„œ ì—¬ëŸ¬ ë¶€ë¶„ì„ ì¶”ì¶œí•˜ì„¸ìš”\n',
'SELECT order_date,\n  EXTRACT(YEAR FROM order_date) AS year,\n  EXTRACT(MONTH FROM order_date) AS month,\n  EXTRACT(DOW FROM order_date) AS day_of_week,\n  EXTRACT(WEEK FROM order_date) AS week\nFROM orders;',
'[{"input": "", "expected": "extracted date parts"}]',
'["EXTRACT(ë¶€ë¶„ FROM ë‚ ì§œ) í˜•ì‹ìœ¼ë¡œ ì‚¬ìš©í•˜ì„¸ìš”"]',
ARRAY['date-function', 'extract', 'hard'], 18),

('sql-time-series-gap', 'sql', 'syntax', 88, 'ì‹œê³„ì—´ ê°„ê²© ì°¾ê¸°', 'ì—°ì†ë˜ì§€ ì•Šì€ ë‚ ì§œ', 'challenge', 3,
'ì¼ë³„ íŒë§¤ ë°ì´í„°ì—ì„œ íŒë§¤ê°€ ì—†ëŠ” ë‚ ì§œë¥¼ ì°¾ìœ¼ì„¸ìš”.',
'- ë‚ ì§œ ì‹œë¦¬ì¦ˆ ìƒì„±\n- LEFT JOINìœ¼ë¡œ ëˆ„ë½ ë‚ ì§œ ì°¾ê¸°',
'[{"input": "", "output": "ëˆ„ë½ëœ ë‚ ì§œ"}]',
'-- íŒë§¤ê°€ ì—†ëŠ” ë‚ ì§œë¥¼ ì°¾ìœ¼ì„¸ìš”\n',
'WITH date_series AS (\n  SELECT generate_series(\n    (SELECT MIN(sale_date) FROM sales),\n    (SELECT MAX(sale_date) FROM sales),\n    \'1 day\'::interval\n  )::date AS date\n)\nSELECT d.date AS missing_date\nFROM date_series d\nLEFT JOIN sales s ON d.date = s.sale_date\nWHERE s.sale_date IS NULL;',
'[{"input": "", "expected": "missing dates"}]',
'["generate_seriesë¡œ ì—°ì†ëœ ë‚ ì§œë¥¼ ë§Œë“¤ê³  LEFT JOINìœ¼ë¡œ ëˆ„ë½ì„ ì°¾ìœ¼ì„¸ìš”"]',
ARRAY['date-function', 'time-series', 'hard'], 25),

('sql-moving-average', 'sql', 'syntax', 89, 'ì´ë™ í‰ê· ', 'ë‚ ì§œ ê¸°ë°˜ ìœˆë„ìš°', 'challenge', 3,
'ìµœê·¼ 7ì¼ê°„ì˜ ë§¤ì¶œ ì´ë™ í‰ê· ì„ ê³„ì‚°í•˜ì„¸ìš”.',
'- ìœˆë„ìš° í•¨ìˆ˜ ì‚¬ìš©\n- RANGE BETWEENìœ¼ë¡œ ë‚ ì§œ ë²”ìœ„ ì§€ì •',
'[{"input": "", "output": "ë‚ ì§œ, ë§¤ì¶œ, 7ì¼í‰ê· "}]',
'-- 7ì¼ ì´ë™ í‰ê· ì„ ê³„ì‚°í•˜ì„¸ìš”\n',
'SELECT sale_date, amount,\n  AVG(amount) OVER (\n    ORDER BY sale_date\n    RANGE BETWEEN INTERVAL \'6 days\' PRECEDING AND CURRENT ROW\n  ) AS moving_avg_7d\nFROM sales;',
'[{"input": "", "expected": "moving averages"}]',
'["RANGE BETWEENìœ¼ë¡œ ë‚ ì§œ ê¸°ì¤€ ë²”ìœ„ë¥¼ ì§€ì •í•˜ì„¸ìš”"]',
ARRAY['date-function', 'window', 'hard'], 22),

('sql-fiscal-year', 'sql', 'syntax', 90, 'íšŒê³„ì—°ë„ ê³„ì‚°', 'ì»¤ìŠ¤í…€ ì—°ë„ ì •ì˜', 'challenge', 3,
'íšŒê³„ì—°ë„(4ì›” ì‹œì‘)ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë°ì´í„°ë¥¼ ê·¸ë£¹í™”í•˜ì„¸ìš”.',
'- CASEë¡œ íšŒê³„ì—°ë„ ê³„ì‚°\n- 4ì›”~3ì›”ì„ í•œ ì—°ë„ë¡œ',
'[{"input": "", "output": "íšŒê³„ì—°ë„, ì´ë§¤ì¶œ"}]',
'-- íšŒê³„ì—°ë„ë³„ ë§¤ì¶œì„ ì§‘ê³„í•˜ì„¸ìš”\n',
'SELECT\n  CASE\n    WHEN EXTRACT(MONTH FROM sale_date) >= 4 THEN EXTRACT(YEAR FROM sale_date)\n    ELSE EXTRACT(YEAR FROM sale_date) - 1\n  END AS fiscal_year,\n  SUM(amount) AS total_sales\nFROM sales\nGROUP BY fiscal_year\nORDER BY fiscal_year;',
'[{"input": "", "expected": "fiscal year sales"}]',
'["4ì›” ì´í›„ë©´ í•´ë‹¹ ì—°ë„, 1~3ì›”ì´ë©´ ì „ë…„ë„ë¥¼ íšŒê³„ì—°ë„ë¡œ í•˜ì„¸ìš”"]',
ARRAY['date-function', 'fiscal', 'hard'], 20);

-- Unit 19: JSON ë° ë°°ì—´ (5 problems - HARD)
INSERT INTO challenges_sql (slug, language, kind, level, title, description, category, difficulty, problem_description, constraints, examples, initial_code, solution_code, test_cases, hints, tags, estimated_time) VALUES
('sql-json-extract', 'sql', 'syntax', 91, 'JSON ë°ì´í„° ì¶”ì¶œ', 'JSON í•„ë“œ ì ‘ê·¼', 'challenge', 3,
'JSON ì»¬ëŸ¼ì—ì„œ íŠ¹ì • í‚¤ì˜ ê°’ì„ ì¶”ì¶œí•˜ì„¸ìš”.',
'- -> ë˜ëŠ” ->> ì—°ì‚°ì ì‚¬ìš©\n- JSON ê²½ë¡œ ì§€ì •',
'[{"input": "", "output": "ID, ì´ë¦„(JSONì—ì„œ ì¶”ì¶œ)"}]',
'-- JSON ì»¬ëŸ¼ì—ì„œ name í‚¤ë¥¼ ì¶”ì¶œí•˜ì„¸ìš”\n',
'SELECT id, data->>\'name\' AS name\nFROM users;',
'[{"input": "", "expected": "extracted json values"}]',
'["->>ëŠ” í…ìŠ¤íŠ¸ë¡œ, ->ëŠ” JSON ê°ì²´ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤"]',
ARRAY['json', 'hard'], 18),

('sql-json-array-elements', 'sql', 'syntax', 92, 'JSON ë°°ì—´ í™•ì¥', 'JSON ë°°ì—´ì„ í–‰ìœ¼ë¡œ', 'challenge', 3,
'JSON ë°°ì—´ í•„ë“œë¥¼ ê°œë³„ í–‰ìœ¼ë¡œ í™•ì¥í•˜ì„¸ìš”.',
'- json_array_elements ì‚¬ìš©\n- LATERAL JOIN',
'[{"input": "", "output": "ID, ë°°ì—´ìš”ì†Œ"}]',
'-- JSON ë°°ì—´ì„ ê°œë³„ í–‰ìœ¼ë¡œ í™•ì¥í•˜ì„¸ìš”\n',
'SELECT id, elem->>\'value\' AS item\nFROM products,\n  LATERAL json_array_elements(data->\'items\') AS elem;',
'[{"input": "", "expected": "expanded array"}]',
'["json_array_elementsë¡œ ë°°ì—´ì˜ ê° ìš”ì†Œë¥¼ í–‰ìœ¼ë¡œ ë§Œë“œì„¸ìš”"]',
ARRAY['json', 'array', 'hard'], 22),

('sql-jsonb-aggregation', 'sql', 'syntax', 93, 'JSON ì§‘ê³„', 'json_agg ì‚¬ìš©', 'challenge', 3,
'ê·¸ë£¹ë³„ í–‰ë“¤ì„ JSON ë°°ì—´ë¡œ ì§‘ê³„í•˜ì„¸ìš”.',
'- json_agg ë˜ëŠ” jsonb_agg\n- JSON ê°ì²´ë¡œ ë³€í™˜',
'[{"input": "", "output": "ë¶€ì„œ, ì§ì›ë°°ì—´(JSON)"}]',
'-- ë¶€ì„œë³„ ì§ì›ì„ JSON ë°°ì—´ë¡œ ì§‘ê³„í•˜ì„¸ìš”\n',
'SELECT dept_id,\n  jsonb_agg(jsonb_build_object(\'name\', emp_name, \'salary\', salary)) AS employees\nFROM employees\nGROUP BY dept_id;',
'[{"input": "", "expected": "json aggregated"}]',
'["jsonb_build_objectë¡œ ê°ì²´ë¥¼ ë§Œë“¤ê³  jsonb_aggë¡œ ë°°ì—´ì„ ë§Œë“œì„¸ìš”"]',
ARRAY['json', 'aggregation', 'hard'], 22),

('sql-array-operations', 'sql', 'syntax', 94, 'ë°°ì—´ ì—°ì‚°', 'ARRAY í•¨ìˆ˜', 'challenge', 3,
'ë°°ì—´ ì»¬ëŸ¼ì—ì„œ íŠ¹ì • ê°’ì´ í¬í•¨ëœ í–‰ì„ ì°¾ìœ¼ì„¸ìš”.',
'- ANY, ALL ë˜ëŠ” @> ì—°ì‚°ì\n- ë°°ì—´ í¬í•¨ ì—¬ë¶€ í™•ì¸',
'[{"input": "", "output": "ID, íƒœê·¸ë°°ì—´"}]',
'-- íƒœê·¸ ë°°ì—´ì— \'sql\'ì´ í¬í•¨ëœ ê²Œì‹œë¬¼ì„ ì°¾ìœ¼ì„¸ìš”\n',
'SELECT id, tags\nFROM posts\nWHERE \'sql\' = ANY(tags);\n-- ë˜ëŠ”: WHERE tags @> ARRAY[\'sql\'];',
'[{"input": "", "expected": "posts with sql tag"}]',
'["ANY(ë°°ì—´)ëŠ” ë°°ì—´ì˜ ì–´ëŠ ìš”ì†Œì™€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤"]',
ARRAY['array', 'hard'], 18),

('sql-array-unnest-filter', 'sql', 'syntax', 95, 'ë°°ì—´ í•„í„°ë§', 'UNNESTì™€ ì¡°ê±´', 'challenge', 3,
'ë°°ì—´ì„ í¼ì¹œ í›„ ì¡°ê±´ì— ë§ëŠ” ìš”ì†Œë§Œ ë‹¤ì‹œ ë°°ì—´ë¡œ ìˆ˜ì§‘í•˜ì„¸ìš”.',
'- UNNESTë¡œ í™•ì¥\n- WHEREë¡œ í•„í„°\n- ARRAY_AGGë¡œ ì¬ìˆ˜ì§‘',
'[{"input": "", "output": "ID, í•„í„°ë§ëœë°°ì—´"}]',
'-- ì ìˆ˜ ë°°ì—´ì—ì„œ 80ì  ì´ìƒë§Œ ë‚¨ê¸°ì„¸ìš”\n',
'SELECT id,\n  ARRAY_AGG(score) AS high_scores\nFROM (\n  SELECT id, UNNEST(scores) AS score\n  FROM students\n) AS expanded\nWHERE score >= 80\nGROUP BY id;',
'[{"input": "", "expected": "filtered arrays"}]',
'["UNNESTë¡œ í¼ì¹˜ê³ , WHEREë¡œ í•„í„°í•˜ê³ , ARRAY_AGGë¡œ ë‹¤ì‹œ ëª¨ìœ¼ì„¸ìš”"]',
ARRAY['array', 'filter', 'hard'], 25);

-- Unit 20: íŠ¸ëœì­ì…˜ê³¼ ê³ ê¸‰ DML (5 problems - HARD)
INSERT INTO challenges_sql (slug, language, kind, level, title, description, category, difficulty, problem_description, constraints, examples, initial_code, solution_code, test_cases, hints, tags, estimated_time) VALUES
('sql-upsert', 'sql', 'syntax', 96, 'UPSERT êµ¬í˜„', 'INSERT ON CONFLICT', 'challenge', 3,
'ì¡´ì¬í•˜ë©´ UPDATE, ì—†ìœ¼ë©´ INSERTí•˜ëŠ” UPSERTë¥¼ êµ¬í˜„í•˜ì„¸ìš”.',
'- INSERT ... ON CONFLICT ì‚¬ìš©\n- DO UPDATE SET',
'[{"input": "", "output": "ì²˜ë¦¬ëœ í–‰"}]',
'-- UPSERTë¥¼ êµ¬í˜„í•˜ì„¸ìš”\n',
'INSERT INTO products (id, name, price)\nVALUES (1, \'Product A\', 1000)\nON CONFLICT (id)\nDO UPDATE SET\n  name = EXCLUDED.name,\n  price = EXCLUDED.price;',
'[{"input": "", "expected": "upserted row"}]',
'["ON CONFLICT (í‚¤)ë¡œ ì¶©ëŒ ì‹œ ë™ì‘ì„ ì§€ì •í•˜ì„¸ìš”"]',
ARRAY['dml', 'upsert', 'hard'], 20),

('sql-merge-statement', 'sql', 'syntax', 97, 'MERGE ë¬¸', 'ì¡°ê±´ë¶€ INSERT/UPDATE/DELETE', 'challenge', 3,
'MERGE ë¬¸ìœ¼ë¡œ ì†ŒìŠ¤ í…Œì´ë¸”ì„ íƒ€ê²Ÿ í…Œì´ë¸”ì— ë™ê¸°í™”í•˜ì„¸ìš”.',
'- MERGE INTO ì‚¬ìš©\n- WHEN MATCHED / NOT MATCHED',
'[{"input": "", "output": "ë³‘í•© ê²°ê³¼"}]',
'-- MERGEë¡œ ë‘ í…Œì´ë¸”ì„ ë™ê¸°í™”í•˜ì„¸ìš”\n',
'MERGE INTO target t\nUSING source s ON t.id = s.id\nWHEN MATCHED THEN\n  UPDATE SET t.value = s.value\nWHEN NOT MATCHED THEN\n  INSERT (id, value) VALUES (s.id, s.value);',
'[{"input": "", "expected": "merged data"}]',
'["MERGEëŠ” ë§¤ì¹­ ì—¬ë¶€ì— ë”°ë¼ ë‹¤ë¥¸ ë™ì‘ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤"]',
ARRAY['dml', 'merge', 'hard'], 25),

('sql-returning-clause', 'sql', 'syntax', 98, 'RETURNING ì ˆ', 'DML ê²°ê³¼ ë°˜í™˜', 'challenge', 3,
'INSERT/UPDATE/DELETE í›„ ë³€ê²½ëœ í–‰ì˜ ì •ë³´ë¥¼ ë°˜í™˜í•˜ì„¸ìš”.',
'- RETURNING * ë˜ëŠ” íŠ¹ì • ì»¬ëŸ¼\n- DML ë¬¸ ë’¤ì— ì¶”ê°€',
'[{"input": "", "output": "ì‚½ì…/ìˆ˜ì •/ì‚­ì œëœ í–‰"}]',
'-- UPDATE í›„ ë³€ê²½ëœ í–‰ì„ ë°˜í™˜í•˜ì„¸ìš”\n',
'UPDATE employees\nSET salary = salary * 1.1\nWHERE dept_id = 10\nRETURNING emp_id, emp_name, salary;',
'[{"input": "", "expected": "updated rows"}]',
'["RETURNINGìœ¼ë¡œ DML ê²°ê³¼ë¥¼ ì¦‰ì‹œ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"]',
ARRAY['dml', 'returning', 'hard'], 18),

('sql-cte-delete', 'sql', 'syntax', 99, 'CTEë¡œ ë³µì¡í•œ DELETE', 'ì¡°ê±´ë¶€ ì‚­ì œ', 'challenge', 3,
'CTEë¥¼ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” ì¤‘ë³µ í–‰ë§Œ ì‚­ì œí•˜ì„¸ìš”.',
'- WITH ... DELETE ì‚¬ìš©\n- ROW_NUMBERë¡œ ì¤‘ë³µ íŒë³„',
'[{"input": "", "output": "ì‚­ì œëœ í–‰ ìˆ˜"}]',
'-- ì´ë©”ì¼ ì¤‘ë³µ ì¤‘ ìµœì‹  ê²ƒë§Œ ë‚¨ê¸°ê³  ì‚­ì œí•˜ì„¸ìš”\n',
'WITH ranked AS (\n  SELECT id,\n    ROW_NUMBER() OVER (PARTITION BY email ORDER BY created_at DESC) AS rn\n  FROM users\n)\nDELETE FROM users\nWHERE id IN (SELECT id FROM ranked WHERE rn > 1);',
'[{"input": "", "expected": "deleted duplicates"}]',
'["CTEë¡œ ì‚­ì œí•  ëŒ€ìƒì„ ë¨¼ì € ì„ ì •í•˜ì„¸ìš”"]',
ARRAY['dml', 'delete', 'hard'], 25),

('sql-multi-table-update', 'sql', 'syntax', 100, 'ë‹¤ì¤‘ í…Œì´ë¸” UPDATE', 'ì¡°ì¸ì„ í†µí•œ ìˆ˜ì •', 'challenge', 3,
'ë‹¤ë¥¸ í…Œì´ë¸”ì˜ ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì—¬ëŸ¬ ì»¬ëŸ¼ì„ ë™ì‹œì— UPDATEí•˜ì„¸ìš”.',
'- UPDATE ... FROM ì‚¬ìš©\n- ì„œë¸Œì¿¼ë¦¬ ë˜ëŠ” ì¡°ì¸ í™œìš©',
'[{"input": "", "output": "ìˆ˜ì •ëœ í–‰ ìˆ˜"}]',
'-- ë¶€ì„œ ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì§ì› ì •ë³´ë¥¼ ì—…ë°ì´íŠ¸í•˜ì„¸ìš”\n',
'UPDATE employees e\nSET\n  dept_name = d.dept_name,\n  location = d.location\nFROM departments d\nWHERE e.dept_id = d.dept_id\n  AND d.status = \'active\';',
'[{"input": "", "expected": "updated employees"}]',
'["FROM ì ˆë¡œ ë‹¤ë¥¸ í…Œì´ë¸”ì„ ì°¸ì¡°í•˜ì—¬ UPDATEí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"]',
ARRAY['dml', 'update', 'hard'], 22);

-- ====================================
-- ì™„ë£Œ ë©”ì‹œì§€
-- ====================================
DO $$
BEGIN
  RAISE NOTICE 'âœ… SQL Part 2 ì™„ë£Œ (50 challenges: 30 MEDIUM + 20 HARD)';
  RAISE NOTICE 'ğŸ“Š SQL ì „ì²´ ì™„ë£Œ: 100 challenges';
END $$;
